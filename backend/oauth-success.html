<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Connection Successful</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#0f766e,#134e4a)}
.card{background:#fff;padding:48px;border-radius:16px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.3);max-width:400px;margin:20px}
.icon{width:64px;height:64px;background:#10b981;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 24px}
.icon svg{width:32px;height:32px;stroke:#fff}
h1{color:#1f2937;font-size:24px;margin-bottom:12px}
p{color:#6b7280;font-size:16px;line-height:1.5}
.loader{width:24px;height:24px;border:3px solid #e5e7eb;border-top-color:#10b981;border-radius:50%;animation:spin 1s linear infinite;margin:20px auto 0}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div class="card">
<div class="icon">
<svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
</svg>
</div>
<h1>Connection Successful!</h1>
<p>GHL location connected successfully. This window will close automatically.</p>
<div class="loader"></div>
</div>
<script>
(function(){
  var params = new URLSearchParams(window.location.search);
  var token = params.get('token');
  var locationId = params.get('locationId');
  var subAccountId = params.get('subAccountId');
  var redirect = params.get('redirect');

  var result = {
    type: 'GHL_OAUTH_RESULT',
    success: true,
    token: token,
    locationId: locationId,
    subAccountId: subAccountId,
    message: 'GHL location connected successfully!'
  };

  if (window.opener) {
    window.opener.postMessage(result, '*');
    try { window.close(); } catch(e) {}
  }

  setTimeout(function(){
    if (redirect) {
      window.location.href = redirect;
    }
  }, 1500);
})();
</script>
</body>
</html>
